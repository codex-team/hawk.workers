dist: trusty
sudo: required
language: node_js
node_js:
  - "12"
services:
  - mongodb
  - rabbitmq
before_install:
  - yarn add global codecov -W
install:
  - yarn install
before_script:
  - chmod +x ./bin/env-config.sh
  - ./bin/env-config.sh
  - sudo rabbitmq-plugins enable rabbitmq_management
  - curl -O http://localhost:15672/cli/rabbitmqadmin
  - chmod +x rabbitmqadmin
  - curl -O https://raw.githubusercontent.com/codex-team/hawk.registry/master/config/rabbit.definitions.json
  - sudo ./rabbitmqadmin import rabbit.definitions.json
script:
  - yarn lint
  - jest --coverage && codecov
